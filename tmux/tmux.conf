# ┌──────────────────────────────────────────────────────────────────────────────┐
# │  ╔════╗  DO NOT EDIT THIS FILE                                               │
# │──╢ 🔒 ╟──────────────────────────────────────────────────────────────────────┤
# │  ╚════╝  Instead, override settings in `~/.tmux_personal`                    │
# ╞══════════════════════════════════════════════════════════════════════════════╡
# │  Docs: https://git.io/fhx1B                                 License: GPL 3.0 │
# └──────────────────────────────────────────────────────────────────────────────┘

# -- GENERAL CONFIGURATION -----------------------------------------------------

set -g prefix C-q                                       # CTRL-Q = CTRL-B
set-option -g mouse on                                  # Mouse enabled.
set -g bell-action any                                  # Ring the bell if bg
                                                        # window rings it.
set -g default-terminal "screen-256color"               # True color configuration
set -ga terminal-overrides ",xterm-256color:Tc"
set -g base-index 1                                     # Window base index.
set-window-option -g pane-base-index 1                  # Pane base index.
set -s escape-time 0                                    # Sets the escape time
                                                        # to 0 to prevent vim delays.
set -g history-limit 10000                              # Increase scrollback lines.
set-option -g set-titles on                             # Set titles automatically.


# -- PANE MOVEMENT WITH VIM SUPPORT---------------------------------------------

is_vim="ps -o state= -o comm= -t '#{pane_tty}' | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
bind-key -n C-h if-shell "$is_vim" "send-keys C-h"  "select-pane -L"
bind-key -n C-j if-shell "$is_vim" "send-keys C-j"  "select-pane -D"
bind-key -n C-k if-shell "$is_vim" "send-keys C-k"  "select-pane -U"
bind-key -n C-l if-shell "$is_vim" "send-keys C-l"  "select-pane -R"
bind-key -n C-\ if-shell "$is_vim" "send-keys C-\\" "select-pane -l"
bind-key -T copy-mode-vi C-h select-pane -L
bind-key -T copy-mode-vi C-j select-pane -D
bind-key -T copy-mode-vi C-k select-pane -U
bind-key -T copy-mode-vi C-l select-pane -R
bind-key -T copy-mode-vi C-\ select-pane -l

# -- PANE MOVEMENT WITH VIM SUPPORT---------------------------------------------

bind-key -n C-S-Left swap-window -t -1                   # Swap window left.
bind-key -n C-S-Right swap-window -t +1                  # Swap window right.


# -- COPY MODE WITH VIM --------------------------------------------------------

bind [ copy-mode
# set-option -g default-command "reattach-to-user-namespace -l zsh"
set-window-option -g mode-keys vi
set -g status-keys vi
set -g @shell_mode 'vi'
bind-key -T copy-mode-vi v send -X begin-selection
bind-key -T copy-mode-vi V send -X select-line
bind-key -T copy-mode-vi y send -X copy-pipe 'clipcopy'
# Bind ']' to use pbpaste
bind ] run "clippaste | tmux load-buffer - && tmux paste-buffer"


# -- TMUX PLUGINS --------------------------------------------------------------

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'odedlaz/tmux-onedark-theme'
set -g @plugin 'tmux-plugins/tmux-yank'


# -- USER DEFINED OVERRIDES ----------------------------------------------------

if '[ -f ~/.tmux_personal ]' 'source ~/.tmux_personal'


# -- TMUX PLUGIN MANAGER -------------------------------------------------------

# Install if it's not already there.
setenv -g TMUX_PLUGIN_MANAGER_PATH "$HOME/.tmux/plugins/"
if "test ! -d ~/.tmux/plugins/tpm" \
    "run 'git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm && \
    ~/.tmux/plugins/tpm/bin/install_plugins'"

# Load.
run '~/.tmux/plugins/tpm/tpm'

